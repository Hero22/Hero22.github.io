---
title: SPRING(2)
date: 2018-05-04 19:02:44
tags:
- Spring

categories: knowledge
---

## 第二章 快速入门
在第二章中，主要讲解了Spring在项目中的一般应用，用到了Spring+Spring JDBC+Spring MVC.这里用的都是Spring提供的相关组件，所以DAO层用的这个.

<!-- more -->

### 2.1 实例概述
这个实例的功能如下：用户进行登录，登录成功提示相应的信息; 登录失败提示信息。实现如下图：
![enter description here](http://pctpggve0.bkt.clouddn.com/images/2018-05-04/Screenshot-from-2018-05-03-11-45-10-300x90.png)
![enter description here](http://pctpggve0.bkt.clouddn.com/images/2018-05-04/Screenshot-from-2018-05-03-11-46-55-300x110.png)

### 2.2 环境准备

#### 2.2.1 构建工具Maven
Maven简单来说就是一个管理项目中所需要的包的工具，如果不用Maven，那么项目中需要的包都需要我们自己下载然后放到项目中去，在自己一个人玩的时候没多大问题，但是在一个团队中，一个项目总是需要不止一个人吧，这时候成员在各自去下载需要的包，就可能会造成项目合并时用到的包的版本不一样什么的问题; 如果用Maven，那么成员就不需要去管理这些包了，通过一个配置文件，所有成员的包都统一了。(ps：以上只是我猜的，我并没有团队开发的经验，所以这也是我刚开始接触Maven)

下载Maven包后，需要配置M2_HOME环境变量，当然使用maven的前提是安装了jdk

在～/.profile或者~/.bashrc修改增加环境变量 ，按照下图方式配置环境变量
![enter description here](http://pctpggve0.bkt.clouddn.com/images/2018-05-04/Screenshot-from-2018-05-03-13-08-13-300x76.png)
注意”:” 相当于分隔符

#### 2.2.2 创建数据库
本例中涉及到两个表，用户表和登录信息表，分别存储用户的信息和用户登录的日志信息.

#### 2.2.3 建立工程
选择新建Maven项目，之后会产生一个pom.xml文件，用来配置包信息，配置文件我直接用的书中给的，想来在一个团队中的话，这个文件应该也是有专人书写直接用吧。另外注意到配置文件中有jetty插件，其实是一个Web应用服务器插件，用来运行web项目.

#### 2.2.4 类包及Spring配置文件规划
类包结构如下图：
![enter description here](http://pctpggve0.bkt.clouddn.com/images/2018-05-04/Screenshot-from-2018-05-03-13-20-58-183x300.png)
Spring配置文件在上图中可以看到有两个，其中smart-context.xml是主要的一个，另外一个是web.xml中配置的servlet所需要的.

### 2.3 持久层
简单理解，持久层就是和数据库进行直接的数据交互的对象，把程序中的对象，例如本例的用户，持久化到数据库中，其实就是在数据库中插入一条用户数据.

#### 2.3.1 建立领域对象

由于该示例比较简单，PO/DO/VO(持久层/服务层/展现层)没什么区别，就直接复用了.
建立两个领域对象: User，LoginLog.

#### 2.3.2 DAO (数据访问对象是一个面向对象的数据库接口)

两个领域对象分别对应一个DAO，在这里进行数据库的操作，用的是Spring JDBC.

#### 2.3.3 在Spring中配置DAO

主要定义JdbcTemplate及其需要的DataSource.

### 2.4 业务层
业务层以下层的持久层为基础，为上层控制层提供服务，简单说来，就是把持久层再次包装，实现更加具体的功能，为控制层所用.

#### 2.4.1 UserService

这里只用一个业务对象UserService，用来实现用户登录时的匹配查找，以及登录成功后相关的更新信息操作.

 

#### 2.4.2 在Spring中装配Service

“事务管理的代码虽然无需出现在程序代码中，但我们必须以某种方式告诉Spring那些业务需要工作在事务环境下以及事务的规则等，以便Spring根据这些信息自动为目标业务添加事务管理的功能。”

也就是说，业务相关的操作需要在事务的环境下，这样操作更加安全。

这里涉及到了AOP相关的知识，我还不是很了解，后边再深入学习。

 

#### 2.4.3 单元测试

这里测试用到的是TestNG，和JUnit在使用中不清楚有什么区别。要注意的是，在使用”assertXXX()”方法时，要引入 org.testng.Assert.*这个静态包，我在用的时候IDEA不会提示我引入，需要自己手动引入该静态包。

### 2.5 展现层
#### 2.5.1 配置Spring MVC框架

这里会用到Spring MVC，首先要对web.xml文件进行配置，来启动Spring容器。需要添加Spring配置文件的地址;添加Spring MVC的地址映射，就是配置一个servlet


#### 2.5.2 处理登录请求

POJO控制器类，用来控制页面的跳转，需要在spring-mvc.xml文件中进行配置


#### 2.5.3 JSP视图页面

写一个登录页面和成功页面.

##Source code
 [https://github.com/Hero22/spring2](https://github.com/Hero22/spring2)

## 小结
写的很简单，把大致的过程浏览了一遍，其中还有很多不懂的地方，比如说Spring容器，SpringMVC容器是什么东西，注解的应用等等，后面还要加油啊啊啊啊啊啊.
